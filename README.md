# W+Jets
This is a GitHub repository created to store the W+Jets simulations, both the fiducial version and the updated simulation with matching &amp; merging implemented.

This document serves as a guide to the various files required to run the simulations, but it should not be regarded as exhaustive!  Please feel free to direct any questions to the author, Ben Johnson: bjohns18@tufts.edu.

After unpacking the VjetsPythia8 tarball, you should see the main code, VjetsPythia8.cc, in addition to a host of supporting files.  Before anything else, it's good form to switch off the login node you're connected to by accessing the cluster via SSH.  You should also initialize ROOT from the CERN Virtual Machine File System (CVMFS).  This can be accomplished easily by accessing the text file included in the tarball named ROOTCopyPasta.txt.  NOTE: there are a few methods of connecting to a computing node and loading ROOT included in this file.  You should only run four lines of code total (you can copy and paste them directly into the terminal).  The first will begin with "srun" (this connects you to a node, and I generally recommend the "largemem" version); then the next two will begin with "export," then "source" (these define a path to where the ROOT versions are stored in the CVMFS, and you should wait a few seconds after running the "source" command); finally, end with one of the lines beginning in "lsetup" to complete the ROOT initialization.  If all goes well, you should now be connected to a computing node running ROOT.  Next, let's cover the command files.

The command files end in .cmnd, and they provide instructions for Pythia to run the physics simulations.  There are four primary command files and two support files.  The primary files are VjetsPythia8.cmnd, VjetsPythia8_kTDurham.cmnd, VjetsPythia8_PTLund.cmnd, and VjetsPythia8_Phase.cmnd.  These each represent different approaches to the W+jets simulation, with the former containing the fiducial version (no merging), while each of the last three implements a different CKKW-L merging scheme.  You will supply one of the primary .cmnd files as a command line input when running the script so that Pythia can perform the simulation as desired.

The two support command files are read in by the main program automatically, and they contain a variety of settings and parameters relevant to the simulation.  These include, but are not limited to, the number of events, the random seed, the tunes, and a variety of Standard Model values like particle masses.  It's essential to properly adjust the support command files when running the simulations, but you don't need to include them on the command line.

Next, we can cover the .sbatch files.  These are Slurm scripts which direct a cluster node to run the Pythia simulation.  There are four nearly identical versions, one for each of the command files.  They should be relatively straightforward, but, in a nutshell, they request time on a node, establish output files for information storage, ensure ROOT setup, then run the executable.

Then, we also need to include a set of dependencies which define assorted classes and functions called by the main program.  The header files all end in .h or .hpp, and the other source files end in .cc.  The primary header shares the same name as the main program: VjetsPythia8.h, but it calls include statements for the other headers: ANA_utils.h(.cc), StdArg.hpp, TruthJets.h(.cc), TruthPart.h(.cc).  The dependencies also have associated object files ending in .o which are created by the compiler before linking everything into the main executable.  Their names match their respective source files: ANA_utils.o, TruthJets.o, TruthPart.o, and the main object file, VjetsPythia8.o.  The compiler names the final executable to match the code, but without an ending--it's simply called VjetsPythia8. This will eventually be run with the command "./VjetsPythia8 <desired-simulation>.cmnd" (either in the terminal or in a Slurm script, just replace <desired-simulation> with the name of the command file of your choice).  Slurm scripts are generally preferable as they allow for parallel computing; running the simulation from the command line will occupy the terminal.  NOTE: ROOT must be initialized first!

Next, in order to run the Pythia simulations with CKKW-L merging, we must provide input files containing events generated by MadGraph (another event generator similar to Pythia) to be used in the merging process.  These are known as Les Houches Event files, and they end in .lhe.  A variety of example .lhe files will be included in the LHEFiles directory within the tarball.  The files beginning with w_production_tree each contain a small set of events, while the others all contain 250,000 (I believe).


